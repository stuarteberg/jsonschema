

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Frequently Asked Questions &mdash; jsonschema 2.5.1.post12 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="jsonschema 2.5.1.post12 documentation" href="index.html"/>
        <link rel="prev" title="Creating or Extending Validator Classes" href="creating.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> jsonschema
          

          
          </a>

          
            
            
              <div class="version">
                2.5.1.post12
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="validate.html">Schema Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Handling Validation Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">Resolving JSON References</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating.html">Creating or Extending Validator Classes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#why-doesn-t-my-schema-that-has-a-default-property-actually-set-the-default-on-my-instance">Why doesn&#8217;t my schema that has a default property actually set the default on my instance?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-jsonschema-version-numbers-work">How do jsonschema version numbers work?</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">jsonschema</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Frequently Asked Questions</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="_sources/faq.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="frequently-asked-questions">
<h1>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="why-doesn-t-my-schema-that-has-a-default-property-actually-set-the-default-on-my-instance">
<h2>Why doesn&#8217;t my schema that has a default property actually set the default on my instance?<a class="headerlink" href="#why-doesn-t-my-schema-that-has-a-default-property-actually-set-the-default-on-my-instance" title="Permalink to this headline">¶</a></h2>
<p>The basic answer is that the specification does not require that
<a class="reference external" href="http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.2">default</a> actually do anything.</p>
<p>For an inkling as to <em>why</em> it doesn&#8217;t actually do anything, consider that none
of the other validators modify the instance either. More importantly, having
<a class="reference external" href="http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.2">default</a> modify the instance can produce quite peculiar things.
It&#8217;s perfectly valid (and perhaps even useful) to have a default that is not
valid under the schema it lives in! So an instance modified by the default
would pass validation the first time, but fail the second!</p>
<p>Still, filling in defaults is a thing that is useful. <a class="reference internal" href="index.html#module-jsonschema" title="jsonschema"><code class="xref py py-mod docutils literal"><span class="pre">jsonschema</span></code></a>
allows you to <a class="reference internal" href="creating.html"><em>define your own validator classes and callables</em></a>, so you can easily create a <code class="xref py py-class docutils literal"><span class="pre">IValidator</span></code> that does do
default setting. Here&#8217;s some code to get you started:</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">jsonschema</span> <span class="kn">import</span> <span class="n">Draft4Validator</span><span class="p">,</span> <span class="n">validators</span>


<span class="k">def</span> <span class="nf">extend_with_default</span><span class="p">(</span><span class="n">validator_class</span><span class="p">):</span>
    <span class="n">validate_properties</span> <span class="o">=</span> <span class="n">validator_class</span><span class="o">.</span><span class="n">VALIDATORS</span><span class="p">[</span><span class="s">&quot;properties&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">set_defaults</span><span class="p">(</span><span class="n">validator</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">schema</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">validate_properties</span><span class="p">(</span>
            <span class="n">validator</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="k">yield</span> <span class="n">error</span>

        <span class="k">for</span> <span class="nb">property</span><span class="p">,</span> <span class="n">subschema</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">if</span> <span class="s">&quot;default&quot;</span> <span class="ow">in</span> <span class="n">subschema</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="nb">property</span><span class="p">,</span> <span class="n">subschema</span><span class="p">[</span><span class="s">&quot;default&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">validators</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="n">validator_class</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;properties&quot;</span> <span class="p">:</span> <span class="n">set_defaults</span><span class="p">},</span>
    <span class="p">)</span>


<span class="n">DefaultValidatingDraft4Validator</span> <span class="o">=</span> <span class="n">extend_with_default</span><span class="p">(</span><span class="n">Draft4Validator</span><span class="p">)</span>


<span class="c"># Example usage:</span>
<span class="n">obj</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">schema</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;properties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="s">&#39;bar&#39;</span><span class="p">}}}</span>
<span class="c"># Note jsonschem.validate(obj, schema, cls=DefaultValidatingDraft4Validator)</span>
<span class="c"># will not work because the metaschema contains `default` directives.</span>
<span class="n">DefaultValidatingDraft4Validator</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">obj</span> <span class="o">==</span> <span class="p">{</span><span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="s">&#39;bar&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>See the above-linked document for more info on how this works, but basically,
it just extends the <a class="reference external" href="http://json-schema.org/latest/json-schema-validation.html#rfc.section.8.3.3.2">properties</a> validator on a
<code class="xref py py-class docutils literal"><span class="pre">Draft4Validator</span></code> to then go ahead and update all the defaults.</p>
<p>If you&#8217;re interested in a more interesting solution to a larger class of these
types of transformations, keep an eye on <a class="reference external" href="https://github.com/Julian/Seep">Seep</a>, which is an experimental data
transformation and extraction library written on top of <a class="reference internal" href="index.html#module-jsonschema" title="jsonschema"><code class="xref py py-mod docutils literal"><span class="pre">jsonschema</span></code></a>.</p>
</div>
<div class="section" id="how-do-jsonschema-version-numbers-work">
<h2>How do jsonschema version numbers work?<a class="headerlink" href="#how-do-jsonschema-version-numbers-work" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">jsonschema</span></code> tries to follow the <a class="reference external" href="http://semver.org/">Semantic Versioning</a>
specification.</p>
<p>This means broadly that no backwards-incompatible changes should be made in
minor releases (and certainly not in dot releases).</p>
<p>The full picture requires defining what constitutes a backwards-incompatible
change.</p>
<p>The following are simple examples of things considered public API, and
therefore should <em>not</em> be changed without bumping a major version number:</p>
<blockquote>
<div><ul class="simple">
<li>module names and contents, when not marked private by Python convention
(a single leading underscore)</li>
<li>function and object signature (parameter order and name)</li>
</ul>
</div></blockquote>
<p>The following are <em>not</em> considered public API and may change without notice:</p>
<blockquote>
<div><ul class="simple">
<li>the exact wording and contents of error messages; typical
reasons to do this seem to involve unit tests. API users are
encouraged to use the extensive introspection provided in
<a class="reference internal" href="errors.html#jsonschema.exceptions.ValidationError" title="jsonschema.exceptions.ValidationError"><code class="xref py py-class docutils literal"><span class="pre">ValidationError</span></code></a>s instead to make
meaningful assertions about what failed.</li>
<li>the order in which validation errors are returned or raised</li>
<li>the <code class="docutils literal"><span class="pre">compat.py</span></code> module, which is for internal compatibility use</li>
<li>anything marked private</li>
</ul>
</div></blockquote>
<p>With the exception of the last two of those, flippant changes are avoided, but
changes can and will be made if there is improvement to be had. Feel free to
open an issue ticket if there is a specific issue or question worth raising.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="creating.html" class="btn btn-neutral" title="Creating or Extending Validator Classes" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013, Julian Berman.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.5.1.post12',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>